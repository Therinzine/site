<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><meta name=robots content="index, follow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Software | Purdue ARC</title><meta name=description content="Learn about the robot arm software stack
"><meta property="og:title" content="Software"><meta property="og:description" content="Learn about the robot arm software stack
"><meta property="og:type" content="article"><meta property="og:url" content="https://purduearc.com/wiki/active-projects/robot-arm/software/"><meta property="article:section" content="wiki"><meta property="article:modified_time" content="2022-08-14T23:20:47-04:00"><meta property="og:site_name" content="Purdue ARC"><meta itemprop=name content="Software"><meta itemprop=description content="Learn about the robot arm software stack
"><meta itemprop=dateModified content="2022-08-14T23:20:47-04:00"><meta itemprop=wordCount content="1730"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="Software"><meta name=twitter:description content="Learn about the robot arm software stack
"><link rel=preload href=/scss/main.min.505db32259e554af32fbaefe47c719d4950cff2f8432a0552a1c0e45ca7f147a.css as=style><link href=/scss/main.min.505db32259e554af32fbaefe47c719d4950cff2f8432a0552a1c0e45ca7f147a.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-00000000-0","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class=navbar-logo></span><span class=font-weight-bold>Purdue ARC</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/wiki/><span class=active>Wiki</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/join/><span>Join</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-wiki-li><a href=/wiki/ title="Purdue ARC Wiki" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-wiki><span>Wiki</span></a><ul class=ul-1><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-wikigeneral-information-li><a href=/wiki/general-information/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikigeneral-information><span>General Information</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikigeneral-informationbidc-info-li><a href=/wiki/general-information/bidc-info/ title="BIDC Information" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikigeneral-informationbidc-info><span>BIDC Info</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikigeneral-informationclub-tools-li><a href=/wiki/general-information/club-tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikigeneral-informationclub-tools><span>Club Tools and Links</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-wikitutorials-li><a href=/wiki/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikitutorials><span>Tutorials</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikitutorialsproject-mgmt-li><a href=/wiki/tutorials/project-mgmt/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikitutorialsproject-mgmt><span>Project Management</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikitutorialswsl2-li><a href=/wiki/tutorials/wsl2/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikitutorialswsl2><span>WSL2</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikitutorialsterminal-li><a href=/wiki/tutorials/terminal/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikitutorialsterminal><span>Using the Terminal</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikitutorialsx-forwarding-li><a href=/wiki/tutorials/x-forwarding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikitutorialsx-forwarding><span>X Forwarding</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikitutorialsros-li><a href=/wiki/tutorials/ros/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikitutorialsros><span>ROS</span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-wikiactive-projects-li><a href=/wiki/active-projects/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projects><span>Active Projects</span></a><ul class="ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-wikiactive-projectsrocket-league-li><a href=/wiki/active-projects/rocket-league/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectsrocket-league><span>Rocket League</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikiactive-projectsrocket-leagueimages-li><a href=/wiki/active-projects/rocket-league/images/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectsrocket-leagueimages><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-wikiactive-projectspiano-hand-li><a href=/wiki/active-projects/piano-hand/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectspiano-hand><span>Piano Hand</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikiactive-projectspiano-handimages-li><a href=/wiki/active-projects/piano-hand/images/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectspiano-handimages><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-wikiactive-projectsrobot-arm-li><a href=/wiki/active-projects/robot-arm/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectsrobot-arm><span>Robot Arm</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-wikiactive-projectsrobot-armsoftware-li><a href=/wiki/active-projects/robot-arm/software/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-wikiactive-projectsrobot-armsoftware><span class=td-sidebar-nav-active-item>Software</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-wikiactive-projectsrobot-armhardware-li><a href=/wiki/active-projects/robot-arm/hardware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikiactive-projectsrobot-armhardware><span>Hardware</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-wikiactive-projectsrobot-armimages-li><a href=/wiki/active-projects/robot-arm/images/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectsrobot-armimages><span></span></a></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-wikiactive-projectswizards-chess-li><a href=/wiki/active-projects/wizards-chess/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectswizards-chess><span>Wizard's Chess</span></a><ul class="ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikiactive-projectswizards-chesssoftware-li><a href=/wiki/active-projects/wizards-chess/software/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikiactive-projectswizards-chesssoftware><span>Software</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikiactive-projectswizards-chesshardware-li><a href=/wiki/active-projects/wizards-chess/hardware/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-wikiactive-projectswizards-chesshardware><span>Hardware</span></a></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child collapse" id=m-wikiactive-projectswizards-chessimages-li><a href=/wiki/active-projects/wizards-chess/images/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-wikiactive-projectswizards-chessimages><span></span></a></li></ul></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"><a href=https://github.com/purdue-arc/site/tree/master/content/en/wiki/Active%20Projects/robot-arm/software.md class=td-page-meta--view target=_blank rel=noopener><i class="fa fa-file-alt fa-fw"></i> View page source</a>
<a href=https://github.com/purdue-arc/site/edit/master/content/en/wiki/Active%20Projects/robot-arm/software.md class=td-page-meta--edit target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/purdue-arc/site/new/master/content/en/wiki/Active%20Projects/robot-arm/software.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" class=td-page-meta--child target=_blank rel=noopener><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/purdue-arc/site/issues/new?title=Software" class=td-page-meta--issue target=_blank rel=noopener><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a id=print href=https://purduearc.com/wiki/active-projects/robot-arm/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a></div><div class=td-toc><nav id=TableOfContents><ul><li><a href=#how-to-use-this-if-youre-new>How to use this if you&rsquo;re new</a></li><li><a href=#system-overview>System Overview</a></li><li><a href=#high-level>High level</a><ul><li><a href=#behavior-planner>Behavior Planner</a></li></ul></li><li><a href=#vision>Vision</a><ul><li><a href=#chess-piece-detection>Chess Piece Detection</a></li><li><a href=#chessboard-detection>Chessboard Detection</a></li></ul></li><li><a href=#control>Control</a><ul><li><a href=#visual-servoing>Visual Servoing</a></li><li><a href=#kinematics-and-planning>Kinematics and Planning</a></li></ul></li><li><a href=#low-level>Low level</a><ul><li><a href=#controller>Controller</a></li><li><a href=#driver>Driver</a></li></ul></li><li><a href=#simulation>Simulation</a><ul><li><a href=#gazebo>Gazebo</a></li></ul></li></ul><ul><li><a href=#tools>Tools</a><ul><li><a href=#ros>ROS</a></li><li><a href=#github>GitHub</a></li><li><a href=#c>C++</a></li><li><a href=#pythonnumpy>Python/Numpy</a></li><li><a href=#arduino>Arduino</a></li><li><a href=#gazebo-1>Gazebo</a></li><li><a href=#good-coding-practices>Good coding practices</a></li></ul></li><li><a href=#algorithms-theory-math>Algorithms, Theory, Math</a><ul><li><a href=#coordinate-transforms>Coordinate Transforms</a></li><li><a href=#fsms>FSMs</a></li><li><a href=#behavior-trees>Behavior Trees</a></li><li><a href=#control-algorithms>Control Algorithms</a></li><li><a href=#ai>AI</a></li></ul></li><li><a href=#sensor-related>Sensor related</a><ul><li><a href=#camera>Camera</a></li><li><a href=#encoders>Encoders</a></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><nav aria-label=breadcrumb class=td-breadcrumbs><ol class=breadcrumb><li class=breadcrumb-item><a href=https://purduearc.com/wiki/>Wiki</a></li><li class=breadcrumb-item><a href=https://purduearc.com/wiki/active-projects/>Active Projects</a></li><li class=breadcrumb-item><a href=https://purduearc.com/wiki/active-projects/robot-arm/>Robot Arm</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://purduearc.com/wiki/active-projects/robot-arm/software/>Software</a></li></ol></nav><div class=td-content><h1>Software</h1><div class=lead>Learn about the robot arm software stack</div><header class=article-meta></header><blockquote><p>If you want to look at code and run some of it, check out <a href=https://github.com/purdue-arc/arc_robot_arm>arc_robot_arm</a> README for quick start details and usage instructions.</p></blockquote><h2 id=how-to-use-this-if-youre-new>How to use this if you&rsquo;re new</h2><p>From the diagram and subsection descriptions, you can hopefully get a preliminary high-level understanding of each of the parts and how they fit together.</p><p>From this, you can then:</p><ol><li>Choose which subsection interests you most</li><li>Follow links in the specified subsection to get more contextual understanding (Optionally ask questions in the Discord, hop in a voice chat, etc for more fun convo about the area)</li><li>Ensure you understand the related topics for each subsections with practical understanding/experience by completing a step-by-step tutorial (either use google to find one or ask for suggestions in Discord), ensuring that it uses the related topics (<strong>Can be done concurrently with #2</strong>)</li><li>At this point, you should have enough knowledge/experience in your subsection to contribute to the current approach and possibly even change what the current approach is if you find better ways to do things (if so, update these docs!)</li></ol><h2 id=system-overview>System Overview</h2><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph
  subgraph Behavior Planning 
    BP1[Behavior Planner]
    BP2[Chess Engine or Human]
    %% BP3[RL Policy]
  end
  subgraph Low Level
    direction LR
    LL1[Protoarm ROS Controller]
    LL2[driver]
    LL3[servos] 
  end
  subgraph Simulation
    direction LR
    S1[Gazebo ROS Controller]
    S2[Simulated robot joints from URDF] 
  end
  subgraph Vision 
    direction LR
    V1[YOLOv5 Object Detector ROS node]
    V2[Chessboard Detector] 
  end
  subgraph Planning/Control
    PC1[Visual Servoing ROS node] 
    PC2[MoveTo C++ ROS node]
    PC3[MoveIt] 
  end

  %% Low level
  LL2 -- servo position PWM --&gt; LL3
  LL3 -- potentiometer feedback \- not done --&gt; LL2
  LL1 --&gt; LL2

  %% Behavior Planning
  BP2 --&gt; BP1 
  BP1 --&gt; PC1 

  %% Vision 
  V2 --&gt; BP1 
  V1 --&gt; PC1

  %% Simulation 
  S1 --&gt; S2
  
  %% Planning/Control 
  PC1 --&gt; PC2
  PC2 --&gt; PC3
  PC3 --&gt; S1
  PC3 --&gt; LL1

  %% Links
  click LL1 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#controller&#34; &#34;Sensors&#34;
  click LL2 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#driver&#34; &#34;Sensors&#34;

  click PC1 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#visual-servoing&#34; &#34;Sensors&#34;
  click PC2 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#kinematics-and-planning&#34; &#34;Sensors&#34;
  click PC3 &#34;https://moveit.ros.org/assets/images/diagrams/moveit_pipeline.png&#34; &#34;Open this in a new tab&#34; _blank

  click BP1 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#behavior-planner&#34; &#34;Sensors&#34;

  click S1 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#simulation&#34; &#34;Sensors&#34;
  click S2 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#simulation&#34; &#34;Sensors&#34;

  click V1 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#chess-piece-detection&#34; &#34;Sensors&#34;
  click V2 href &#34;http://wiki.purduearc.com/wiki/robot-arm/software#chessboard-detection&#34; &#34;Sensors&#34;

  classDef not_started fill:#ff8181
  classDef in_progress fill:#ffba82
  classDef done fill:#81ff9b
  class BP1,LL1,BP2,BP3,V2 not_started
  class PC1 in_progress
  class S1,S2,LL2,LL3,V1,PC2,PC3 done
</code></pre><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph
  l1[Not Started]
  l2[In Progress]
  l3[Done]
classDef not_started fill:#ff8181
classDef in_progress fill:#ffba82
classDef done fill:#81ff9b
class l1 not_started
class l2 in_progress
class l3 done
</code></pre><h2 id=high-level>High level</h2><h3 id=behavior-planner>Behavior Planner</h3><p>After the robot turns on or at any given point of time, what should the robot do? This is the job of the behavior planner.</p><p>Overall, it should output executable commands that return true or false if they are completed successfully and then output the next command. A preliminary decision flowchart that a robot can make is modeled here:</p><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph
  a1[Scanning for change in board state]
  p1[Virtual Human]
  p2[Engine]
  a3[Identify and pick up piece]
  a4[Identify destination and place piece]
  a1 -- 2d picture of board --&gt; p1
  a1 -- FEN Notation of board--&gt; p2
  p1 -- Next move --&gt; a3
  p2 -- Next move --&gt; a3
  a3 --&gt; a4 --&gt; a1
</code></pre><p>To implement the behavior planner, a Finite State Machine (FSM) and/or a Behavior Tree (BT) can be used, which both have tradeoffs in <strong>modularity</strong> and <strong>reactivity</strong>, (<a href=https://roboticseabass.com/2021/05/08/introduction-to-behavior-trees/>read more</a>, scroll to the last section for ).</p><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#fsm>FSM</a> and/or <a href=https://wiki.purduearc.com/wiki/robot-arm/software#behavior-trees>BT</a></li></ul><h2 id=vision>Vision</h2><h3 id=chess-piece-detection>Chess Piece Detection</h3><p>How does our robot determine which piece is which and where is that piece relative to the arm? This is a common scenario in many real-world use cases and object detection, as the name suggests, is used to detect the chess pieces.</p><p>The object detection stack consists of the <a href=https://github.com/ultralytics/yolov5>YOLOv5</a> object detection model trained on a custom dataset and outputs 2d bounding boxes. This can then be extrapolated to 3D coordinates from the camera intrinsics relative to the arm with some coordinate transformations from camera -> robot arm base.</p><p>For chess, the model is trained with a custom large chess piece dataset of 500+ images stored on <a href=https://app.roboflow.com/>roboflow</a>. <a href="https://colab.research.google.com/drive/1XJ82eVA0cEfTczXFMtV1sunqvsfiJWQ0?usp=sharing">Here</a> is a simple colab that walks through the training process using a Roboflow dataset.</p><p>Inference is using the <code>yolov5_pytorch_ros</code> ROS package using the <code>detector</code> ROS node using Python/PyTorch, allowing it to communicate detections and classes to other nodes such as for visual servoing. It reaches around 15-20 FPS without a GPU on a Mac.</p><blockquote><p>See <a href=https://github.com/purdue-arc/arc_robot_arm/tree/main/chess_piece_detector>chess_piece_detector</a> for quick start details and usage instructions.</p></blockquote><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#object-detection>Object Detection using YOLOv5</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#coordinate-transforms>Coordinate Transformations</a></li></ul><h3 id=chessboard-detection>Chessboard Detection</h3><p>Playing chess is more than just picking and placing pieces. The robot needs to actually beat the human. We need to know the exact state of the chessboard, so another person or an overpowered engine can say what move to play next.</p><p>We can do this using a computer vision techniques with an image of the current chessboard as an input and the FEN notation of to board as an output. The following diagram shows this visually:</p><pre tabindex=0><code class=language-mermaid data-lang=mermaid>graph LR
  a1[Real chessboard] --&gt; a2[2D chessboard] 
  a2 --&gt; a3[FEN Notation] 
  a3 --&gt; a4[Chess Engine]
  a2 --&gt; a5[Virtual human player]
</code></pre><p>Some external projects we plan to use to complete the above:</p><ul><li><a href=https://github.com/maciejczyzewski/neural-chessboard>Real chessboard -> 2D chessboard</a></li><li><a href=https://github.com/Elucidation/tensorflow_chessbot>2D chessboard -> FEN Notation</a></li></ul><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#machine-learning>Machine Learning</a></li></ul><h2 id=control>Control</h2><h3 id=visual-servoing>Visual Servoing</h3><p>Even if we can see where the pieces are with the camera, how does the robot arm move closer to the chess piece it wants to pick up? Without visual servoing, any error that the robot makes cannot be accounted for and adjusted for accordingly, resulting in lots of fails. Visual servoing is a control algorithm using images as input to control for any errors that the robot makes.</p><p>We are using image-based visual servoing to localize the robot arm hand over an object in a graspable configuration, using images/2d bounding boxes as inputs to the system and servo commands as outputs.</p><img src=/wiki/active-projects/robot-arm/images/vs-diagram.png alt="Diagram of controller" width=400>
> Visual servoing system diagram ([source](https://www.researchgate.net/figure/Visual-servoing-closed-loop_fig1_265436696))<p>See the <code>protoarm_visual_servoing</code> package for more details.</p><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#visual-servoing-1>Visual Servoing</a></li><li>Usage of the MoveTo node</li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#coordinate-transforms>Coordinate Transforms</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#robot-arm-kinematics>Robot Arm Kinematics</a></li></ul><h3 id=kinematics-and-planning>Kinematics and Planning</h3><p>As a human, it is simple to move our joints and pick something up in 3D space. For a robot arm, it knows nothing of 3D space, only numerical angles for each of its joints. So, we use <a href=https://en.wikipedia.org/wiki/Inverse_kinematics>inverse kinematics</a> (IK), the mathematical process of converting 3D space coordinates to joint angles, to determine the final position for the robot arm.</p><p>Now what happens between the start and final position? That&rsquo;s the job of the motion planner. It determines a safe collision-free trajectory for each joint and creates the plan. Then, the plan is executed, either in real life or in simulation.</p><p>As of now, all the kinematics and planning heavy lifting is done by <a href=http://moveit.ros.org/>MoveIt</a>. The <code>protoarm_kinematics</code> package houses a wrapper written in C++ that abstracts the process of sending <a href=http://docs.ros.org/en/melodic/api/sensor_msgs/html/msg/JointState.html>JointState</a> or <a href=http://docs.ros.org/en/noetic/api/geometry_msgs/html/msg/Pose.html>Pose</a> goals.</p><p>The wrapper is interfaced externally using the <code>move_to</code> node. Refer to the <a href=https://github.com/purdue-arc/arc_robot_arm/blob/main/protoarm_kinematics/src/test_kinematics>test_kinematics</a> rospy file in <code>protoarm_kinematics/src</code> for usage of the <code>move_to</code> node.</p><p>This package is also where we would keep our custom kinematics plugin and planning library if we choose to make it from scratch, instead of the default <a href=https://ros-planning.github.io/moveit_tutorials/doc/kinematics_configuration/kinematics_configuration_tutorial.html#the-kdl-kinematics-plugin>KDL</a> kinematics plugin and <a href=https://ros-planning.github.io/moveit_tutorials/doc/ompl_interface/ompl_interface_tutorial.html>OMPL</a> motion planning library.</p><blockquote><p>See <a href=https://github.com/purdue-arc/arc_robot_arm/tree/main/protoarm_kinematics>protoarm_kinematics</a> for quick start details and usage instructions.</p></blockquote><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#moveit>MoveIt</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#coordinate-transforms>Coordinate Transforms</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#robot-arm-kinematics>Robot Arm Kinematics</a></li></ul><h2 id=low-level>Low level</h2><h3 id=controller>Controller</h3><p><code>protoarm_control</code> is the ROS package that ensures that MoveIt execution commands are executed exactly as expected and to a degree of certainty in the real world.</p><p>Right now, the driver communicates directly with MoveIt as the <code>protoarm_control</code> package doesn&rsquo;t exist yet and because we do not have servo feedback.</p><p>Given that the protoarm uses some of the cheapest servos on the market, how can we still get dependable sub-millimeter precision to do tasks reliably? One way to do so is to hack our servos to add encoders, and use a control scheme that can take velocity and torque into account.</p><p>Inspired by Adam&rsquo;s <a href=https://github.com/adamb314/ServoProject>Servo Project</a>.</p><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#ros>ROS</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#pythonnumpy>Python</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#cascade-style-control>Cascade-style Control</a></li><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#encoders>Encoders</a></li></ul><h3 id=driver>Driver</h3><p>The <code>protoarm_driver</code> is written in Arduino that actually interfaces with the servos and encoders. It sets joint limits, does coordinate frame conversions from the URDF to the actual robot, converts MoveIt angles to servo joint angles $$(-\pi,\pi)$$ to $$(0^\circ,180^\circ)$$, and executes servo commands using PWM to the servos.</p><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#arduino>Arduino</a></li></ul><h2 id=simulation>Simulation</h2><h3 id=gazebo>Gazebo</h3><p>There are lots of benefits from simulation spanning from speeding up development and testing of software, realistic environments for reinforcement learning, and testing proof of concepts.</p><p>Our arm is simulated in Gazebo with a Realsense D435 camera (<code>realsense_ros_gazebo</code>), chessboard, and chess pieces (<code>chessboard_gazebo</code>). The robot arm and the camera are represented in <a href=http://wiki.ros.org/urdf/XML/model>URDF</a>.</p><p>Sensors, actuation, gazebo plugins, and more are <a href=http://wiki.ros.org/urdf/XML>specifications</a> that can be added. For the arm, these specifications exist in the <code>.xacro</code> files in the <code>urdf</code> folder of the <code>protoarm_description</code> ROS package.</p><p>Gazebo uses SDF models (in <code>models</code> folder of <code>chessboard_gazebo</code>) to represent static assets in the simulation like the chess pieces and chessboard. These objects are then spawned into a Gazebo world (along with the robot URDF), represented with a <code>.world</code> file.</p><blockquote><p>See <a href=https://github.com/purdue-arc/arc_robot_arm/tree/main/protoarm_bringup>protoarm_bringup</a> for quick start details and usage instructions.</p></blockquote><p>{% include googleDrivePlayer.html id=&ldquo;19FZ7lsqCn6DEChjjdBgsTy0feUANYaVO/preview&rdquo; %}</p><p><strong>Related Topics:</strong></p><ul><li><a href=https://wiki.purduearc.com/wiki/robot-arm/software#gazebo-1>Gazebo</a></li><li><a href>URDF</a></li></ul><h1 id=resources>Resources</h1><h2 id=tools>Tools</h2><h3 id=ros>ROS</h3><ul><li><a href=https://wiki.purduearc.com/wiki/tutorials/snake-tutorial>ARC ROS tutorials (Recommended)</a></li><li><a href=http://wiki.ros.org/ROS/Tutorials>Official ROS tutorials</a></li></ul><h3 id=github>GitHub</h3><ul><li><a href=https://www.freecodecamp.org/news/learn-the-basics-of-git-in-under-10-minutes-da548267cc91/>Learn Git under 10 min</a></li></ul><h3 id=c>C++</h3><ul><li><a href="https://www.youtube.com/watch?v=18c3MTX0PK0&list=PLlrATfBNZ98dudnM48yfGUldqGD0S4FFb">In depth tutorial playlist for C++</a><ul><li>Recommended topics:<ul><li>if/else, loops, functions, classes</li><li>Pointers/References</li><li>Smart pointers</li><li>Dynamic Arrays (std::vector)</li></ul></li></ul></li><li>Very useful numeric libraries<ul><li><a href="https://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen</a>: Extremely efficient matrix math library</li></ul></li></ul><h3 id=pythonnumpy>Python/Numpy</h3><p><strong>Python</strong></p><ul><li><a href="https://www.youtube.com/watch?v=rfscVS0vtbw">Tutorial</a></li><li>Important topics to understand:<ul><li>Basics are good - variables + logic, functions, classes</li></ul></li></ul><p><strong>Numpy</strong></p><blockquote><p>Must use when working with large arrays (i.e images)</p></blockquote><ul><li><a href="https://www.youtube.com/watch?v=8Y0qQEh7dJg">Tutorial</a></li><li>Important topics to understand:<ul><li>Creating arrays</li><li>slicing + indexing</li><li>reshaping</li><li>linear algebra</li></ul></li></ul><p><strong>OpenCV</strong>:</p><blockquote><p>Use for computer vision and image transformations like color detection, tracking, etc</p></blockquote><ul><li><a href="https://www.youtube.com/watch?v=oXlwWbU8l2o">Tutorial</a></li><li>Important topics to understand:<ul><li>image transformation</li><li>thresholding</li><li>read/write images from file</li><li>resizing</li><li>tracking</li></ul></li></ul><h3 id=arduino>Arduino</h3><ul><li>Top hit for &ldquo;arduino tutorial&rdquo; on google should work</li></ul><h3 id=gazebo-1>Gazebo</h3><ul><li>Important topics (Googlable)<ul><li>Creating a world</li><li>Adding assets</li><li>ROS control in Gazebo</li><li>Cameras in Gazebo</li></ul></li></ul><h3 id=good-coding-practices>Good coding practices</h3><ul><li><a href=https://cpp-optimizations.netlify.app/>Optimized C++ code</a></li></ul><p>TODO</p><h2 id=algorithms-theory-math>Algorithms, Theory, Math</h2><h3 id=coordinate-transforms>Coordinate Transforms</h3><ul><li><a href=http://faculty.salina.k-state.edu/tim/robotics_sg/Pose/Pose.html>Understanding the pose of a robot</a></li></ul><h3 id=fsms>FSMs</h3><ul><li><a href=https://www.clear.rice.edu/engi128/Handouts/Lec17-Robotics.pdf>tutorial slideshow</a></li></ul><h3 id=behavior-trees>Behavior Trees</h3><ul><li><a href=https://roboticseabass.com/2021/05/08/introduction-to-behavior-trees/>intro to behavior trees</a></li></ul><h3 id=control-algorithms>Control Algorithms</h3><h4 id=pid-controller>PID Controller</h4><ul><li><a href="https://ctms.engin.umich.edu/CTMS/index.php?example=Introduction&section=ControlPID">tutorial</a></li></ul><h4 id=cascade-controller>Cascade Controller</h4><ul><li><a href=https://github.com/adamb314/ServoProject>Implememtation by Adam for Servo Project</a></li></ul><h3 id=ai>AI</h3><h4 id=object-detection>Object Detection</h4><ul><li><a href=https://blog.roboflow.com/how-to-train-yolov5-on-a-custom-dataset/>train yolov5 model on custom dataset</a></li></ul><h4 id=machine-learning>Machine Learning</h4><h2 id=sensor-related>Sensor related</h2><h3 id=camera>Camera</h3><ul><li><a href>Camera driver ROS package</a></li><li><a href>Camera calibration ROS package</a></li></ul><h3 id=encoders>Encoders</h3><ul><li><a href=https://www.arduino.cc/reference/en/libraries/encoder/>Arduino Encoder Package</a></li></ul><div class="text-muted mt-5 pt-3 border-top">Last modified August 14, 2022: <a href=https://github.com/purdue-arc/site/commit/58931f14fc851394326ae9f056fa2aecedc067a5>added a lot of final revisions (58931f1)</a></div></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://mobile.twitter.com/purduerobotics aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/purdue-arc aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/ddkzfD2cyu aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2022 Purdue ARC All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js integrity="sha512-UR25UO94eTnCVwjbXozyeVd6ZqpaAE9naiEUBK/A+QDbfSTQFhPGj5lOR6d8tsgbBk84Ggb5A3EkjsOgPRPcKA==" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.aebb4087d608eeae579e098f961a0adca05a467aea516b216f2533775ccff5ce.js integrity="sha256-rrtAh9YI7q5XngmPlhoK3KBaRnrqUWshbyUzd1zP9c4=" crossorigin=anonymous></script></body></html>