<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://purduearc.com/wiki/active-projects/rocket-league/><link rel=alternate type=application/rss+xml href=https://purduearc.com/wiki/active-projects/rocket-league/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192><title>Rocket League | Purdue ARC</title><meta name=description content="Teaching cars to play soccer
"><meta property="og:title" content="Rocket League"><meta property="og:description" content="Teaching cars to play soccer
"><meta property="og:type" content="website"><meta property="og:url" content="https://purduearc.com/wiki/active-projects/rocket-league/"><meta property="og:site_name" content="Purdue ARC"><meta itemprop=name content="Rocket League"><meta itemprop=description content="Teaching cars to play soccer
"><meta name=twitter:card content="summary"><meta name=twitter:title content="Rocket League"><meta name=twitter:description content="Teaching cars to play soccer
"><link rel=preload href=/scss/main.min.5f4076087349a426baccf15da1bf1377e3d88edfa841e29d6e8c1eed1083fd39.css as=style><link href=/scss/main.min.5f4076087349a426baccf15da1bf1377e3d88edfa841e29d6e8c1eed1083fd39.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-00000000-0"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-00000000-0")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><span class="navbar-brand__logo navbar-logo"></span><span class=navbar-brand__name>Purdue ARC</span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/about/><span>About</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/wiki/><span class=active>Wiki</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/blog/><span>Blog</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/join/><span>Join</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class=td-search><div class=td-search__icon></div><input type=search class="td-search__input form-control td-search-input" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/wiki/active-projects/rocket-league/>Return to the regular view of this page</a>.</p></div><h1 class=title>Rocket League</h1><div class=lead>Teaching cars to play soccer</div><ul><li>1: <a href=#pg-1ed627e854ef9a1cdbe731ad50f47162></a></li><ul></ul></ul><div class=content><h2 id=goal>Goal</h2><p>Build a system of autonomous, scaled vehicles to play head-to-head in a game of high-speed soccer. Inspiration draws from the game, Rocket League, in which rocket-powered vehicles play soccer in 3v3 matches.</p><p>Current tasks are aimed at creating an interactive demo, where a team of human controlled cars compete against a team of autonomous cars. Future work may entail using the working system to launch a multi-university competition. Teams would build their own autonomous strategies and face-off in a tournament bracket.</p><h2 id=system-overview>System Overview</h2><p>Our system is organized into several components, which function together to create an autonomous Rocket League car.</p><p><img src=images/system-overview.png alt="System Overview"></p><p>The system consists of several specialized layers, which each reduce abstraction as information flows from the top of the diagram to the bottom. For example, a control effort (ex: put the steering wheel at 10 degrees) is less abstract than a collision goal (ex: hit the ball at position (3,5) cm in the (1,0) direction). Each layer refines the previous command until it is eventually something usable by the car&rsquo;s hardware.</p><p>Each layer also utilizes feedback in order to correct errors. For example, the velocity controller may notice the car&rsquo;s velocity is too fast, and then step slightly off the throttle to correct. Each layer uses a common perception system as a truth to compare against.</p><p>For more information on each layer / subsystem, see the below sections to learn more about its input and output, and how it processes it (including the software and languages in use).</p><h3 id=intercommunication>Intercommunication</h3><p>Like most ARC projects, Rocket League uses <a href=https://www.ros.org/about-ros/>ROS</a> to handle communication between each component. ROS is compatible with the Python, C++, and Arduino used on the project.</p><blockquote><p>Documentation on setting up and learning about your ROS development evironment can be found <a href=/wiki/tutorials/ros>here</a>.</p></blockquote><h3 id=high-level-planner>High Level Planner</h3><p>This component uses deep reinforcement learning in order to develop strategies for playing Rocket League. It is still being prototyped in Python, using PyTorch and Keras (Tensorflow). When complete, it will recieve the full state of the game, and output a collision goal (where, when, and in what direction to hit the ball) to the Mid Level Software stack.</p><p>An end-to-end model is also being considered, which would replace all of the Mid Level Software by increasing the complexity of the High Level Planner. If built, this would exist for comparison with the existing system for learning purposes.</p><blockquote><p>This is a component that will see a lot of attention during the Fall 2021 semester</p></blockquote><p>It utilizes a simulator for training, which is described below.</p><h4 id=simulator>Simulator</h4><p>This component exists for training the High Level Planner, and testing / debugging Mid Level Software. It is written in Python, using the Box2D physics engine, and must realistically simulate all physical elements of the game. It can be used to replace everything below Mid Level Software (including the Velocity Controller and Perception) if the entire game is to be run in simulation.</p><h3 id=mid-level-sotware>Mid Level Sotware</h3><p>Together, the Trajectory Planner and Waypoint Controller (both implemented in Python) recieve a collision goal and are responsible for guiding the car to acheive the goal by outputting instantaneous velocity commands for the car.</p><h4 id=trajectory-planner>Trajectory Planner</h4><p>This component considers the car&rsquo;s current location and velocity, and the collision goal, to generate a trajectory for the car to follow. It can operate in several modes to generate trajectories via different mathematical functions, and has many many many configurable settings.</p><h4 id=waypoint-controller>Waypoint Controller</h4><p>This component is what enables the car to follow the generated trajectories. It commands the car to follow specific velocities and wheel angles by applying the <a href="https://www.mathworks.com/help/robotics/ug/pure-pursuit-controller.html#:~:text=Pure%20pursuit%20is%20a%20path,in%20front%20of%20the%20robot.&text=You%20can%20think%20of%20this,point%20in%20front%20of%20it.">pure pursuit algorithm</a> on the path given by the trajectory planner.</p><h3 id=velocity-controller>Velocity Controller</h3><p>This component (also called the low-level controller) adjusts the control efforts (specific throttle and steering values) such that the velocity and heading of the car matches the desired setpoint from the waypoint controller. It implements a PID controller, and is currently written in Python. Future work may see it ported to a different language, such as C++ or MATLAB.</p><h3 id=hardware-inferface>Hardware Inferface</h3><p>This component allows communication to occur between the ROS network and the RC car.</p><p>Control efforts to the car are broadcasted using a FrSky XJT transmitter. These messages are encoded by an Arduino script running on a Teensy 3.1, which communicates to the radio using a digital PPM signal. ROS Serial is used to send the desired efforts to be encoded to the Teensy from the ROS network.</p><p>An image of the hardware for one car is shown below:</p><p><img src=images/ros-interface.jpg alt="ROS Interface Hardware"></p><h3 id=car>Car</h3><p>The car is the complete physical system of one player on the field. Tests were performed on off-the-shelf cars, however none met the desired criteria for acceleration and control. To solve this issue, the team upgraded the electronics of the best-tested car and found much increased performance.</p><div class=embed-container><iframe width=640 height=480 src=https://drive.google.com/file/d/1hoZkHQMXcIDrOJjSXYIXwCfNXiyw8jH6/preview frameborder=0 allowfullscreen></iframe></div><blockquote><p>Left: upgraded car, middle & right: stock cars</p></blockquote><p>The car&rsquo;s upgrades replaced the servo motors, receiver, speed controller, and battery.</p><blockquote><p>Documentation will be created in the Fall 2021 semester to have step-by-step upgrade instructions to build a matching car</p></blockquote><h3 id=environment>Environment</h3><p>Work has been done towards creating a consistent environment for operating the cars and providing infrastructure for localization.</p><p>In Spring 2021, physical tests were performed on Krach&rsquo;s carpet and used plywood planks to provide boundaries. Tripods with PVC tubes were also used to hold multiple cameras necessary for localization.</p><p><img src=images/full-field.png alt="Full Field"></p><p>Future work intends on using aluminum square tubing to rigidly mount cameras with the addition of 3D printed mounts.</p><p><img src=images/camera-mounting.png alt="Camera mount"></p><h3 id=perception>Perception</h3><p>The perception system is responsible for tracking odometry (position, orientation, linear velocity, and angular velocity) for each car and the position and velocity of the ball.</p><p>In the prototype system, cars are tracked through <a href="https://april.eecs.umich.edu/software/apriltag#:~:text=AprilTag%20is%20a%20visual%20fiducial,tags%20relative%20to%20the%20camera.">AprilTags</a> and the ball through OpenCV color thresholding techniques. ARC uses C++ for both systems.</p><p>In order to capture the size of the operating field, multiple cameras are required. The current system uses two PointGrey (FLIR) cameras and two Basler cameras.</p><p>Processing AprilTags for each camera is computationally expensive, so the team invested in a &ldquo;Computation Cart&rdquo; with two desktop PCs. Each PC is responsible for two cameras.</p><p><img src=images/computation-cart.jpg alt="Computation Cart"></p><p>Information from each desktop is then communicated over the ROS network:</p><p><img src=images/multiple-cameras.png alt=Multi-Cam></p><h2 id=future-work>Future work</h2><p>The team has outlined the following objectives in working towards the overall goal:</p><ul><li>Proving the high-level framework on snake game</li><li>Testing and tuning of simulator for usage in training high-level planner</li><li>Completion of camera mounting infrastructure</li><li>Completion of field manufacturing</li><li>Perception system scaling / redesign</li></ul><h2 id=quick-links>Quick links</h2><ul><li><a href=https://github.com/purdue-arc/rocket_league>GitHub</a></li><li><a href="https://drive.google.com/file/d/1zw7jYFSYIVamnQTyYaT1TCJGP7sZOg1J/view?usp=sharing">Spring 2021 Presentation</a></li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-1ed627e854ef9a1cdbe731ad50f47162>1 -</h1></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank rel=noopener href=https://mobile.twitter.com/purduerobotics aria-label=Twitter><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/purdue-arc aria-label=GitHub><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Discord aria-label=Discord><a class=text-white target=_blank rel=noopener href=https://discord.gg/ddkzfD2cyu aria-label=Discord><i class="fab fa-discord"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Purdue ARC All Rights Reserved</small>
<small class=ml-1><a href=https://policies.google.com/privacy target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=/js/main.min.7cefd0b4fd701d2ed63770cd335a32296fb92d97c9b825c65fb3f7853e5a22b9.js integrity="sha256-fO/QtP1wHS7WN3DNM1oyKW+5LZfJuCXGX7P3hT5aIrk=" crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script></body></html>